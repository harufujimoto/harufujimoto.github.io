---
layout: post
title: "エラトステネスのふるい,素因数分解"
---

コンストラクタによってmin_factorテーブルが作られる。これは、min_factor[x] = (xを割り切る最小の素数)。

factor(int N) : Nの素因数を列挙する。複数回割り切るものは割り切る回数だけpush_backされている。素因数のsetが欲しい場合は適当に書き換えるか、erase(unique)する。


{% highlight cpp %}
struct Sieve{
  vector<int> min_factor;
  Sieve(int n = 1000001)
  {
    min_factor.assign(n,0);
    for (int i = 2; i*i < n; ++i) {
      if (min_factor[i] < i) continue;
      for (int j = i*i; j < n; j += i)
        if (min_factor[j] == j) min_factor[j] = i;
    }
  }
  Sieve(){
    Sieve(1000000);
  }
  vector<int> factor(int n){
    vector<int> res;
    while (n > 1) {
      res.push_back(min_factor[n]);
      n /= min_factor[n];
    }
    return res;
  }
};
{% endhighlight %}
