---
layout: page
title: "DFS木について"
---

[edit](https://github.com/harufujimoto/harufujimoto.github.io/blob/master/_posts/graph/2020-09-11-dfstree.md)

[これを読む](https://codeforces.com/blog/entry/68138)

DFS木とは、グラフ上でDFSをした結果構成される全域木のこと。全域木に含まれる辺をspanning-edge , 含まれない辺をback-edgeと呼ぶ。

## 橋の探索

頂点uから頂点vへの辺を考える。ここで、uの方がvよりも「親側」の頂点であるとする。この時、辺u-vが「橋」であることと、「uの祖先とvの子孫とを結ぶback-edgeが存在しないこと」は同値である。また、back-edgeは橋にはなり得ない。

橋を探すためのアルゴリズムは、

- DFS treeを見つける。
- それぞれのspan-edgeについて、dp\[u] := (頂点uから根に向かって伸びるback-edgeの本数） - (頂点uから子孫に向かって降りるback-edgeの本数） + (uの部分木のdp\[]の総和）を計算する。ここでdp\[u] == 0を満たすことと、頂点uとその親とを結ぶ辺が橋であることが同値である。
